<script>
    // Função para extrair o número do parâmetro da URL
    function getParameterFromURL() {
        const params = new URLSearchParams(window.location.search);
        return Array.from(params.entries())[0][1];  // Pega o valor do primeiro parâmetro da URL
    }

    // Função para acessar a página fonte e obter os links
    async function fetchLinks() {
        try {
            const id = getParameterFromURL();
            const response = await fetch('https://bhdspro.github.io/redirecto/fonte.html');
            const text = await response.text();

            // Expressões regulares para buscar os links específicos
            const fLinkPattern = new RegExp(`f${id}=(https?://[^\"]+)`);
            const dLinkPattern = new RegExp(`d${id}=(https?://[^\"]+)`);

            const fLinkMatch = text.match(fLinkPattern);
            const dLinkMatch = text.match(dLinkPattern);

            if (fLinkMatch && dLinkMatch) {
                const fLink = fLinkMatch[1];
                const dLink = dLinkMatch[1];

                // Carrega o iframe invisível com o site fXXX
                const iframe = document.getElementById('hiddenIframe');
                iframe.src = fLink;

                // Monitora o carregamento completo do iframe
                iframe.onload = function() {
                    // Redireciona para o dXXX
                    window.location.href = dLink;
                };
            } else {
                console.error('Links não encontrados para o ID especificado.');
            }
        } catch (error) {
            console.error('Erro ao buscar os links:', error);
        }
    }

    // Executa a função de busca dos links ao carregar a página
    window.onload = function() {
        fetchLinks();
    };
</script>
